{__NOLAYOUT__}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
  <link rel="stylesheet" href="__ZHUCE__layer_mobile/need/layer.css" />
  <script type="text/javascript" src="__CSS__js/jquery-1.11.2.min.js"></script>
  <script type="text/javascript" src="__ZHUCE__layer_mobile/layer.js"></script>
  <title>服务通知详情</title>
  <style type="text/css">
    #alertMsg {
      display: none;
      width: 300px;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-shadow: 1px 1px 1px black;
      padding: 10px 10px;
      font-size: 18px;
      position: absolute;
      text-align: center;
      background: #fff;
      z-index: 100000;

    }

    #alertMsg_info {
      padding: 10px 20px;
      line-height: 1.6em;
      text-align: left;
    }

    #alertMsg_btn1,
    #alertMsg_btn2 {
      display: inline-block;
      /* background: url(images/gray_btn.png) no-repeat left top; */
      padding-left: 3px;
      color: #000000;
      font-size: 18px;
      text-decoration: none;
      margin-right: 10px;
      cursor: pointer;
    }

    #alertMsg_btn1 cite,
    #alertMsg_btn2 cite {
      line-height: 24px;
      display: inline-block;
      padding: 0 13px 0 10px;
      /* background: url(images/gray_btn.png) no-repeat right top; */
      font-style: normal;
    }
  </style>
  <input type="hidden" value="{$openid}" class="openid">
  <input type="hidden" value="{$s_id}" class="s_id">
</head>

<body>
  <script type="text/javascript">
    alertMsg('你的免费体验次数已用完，需要服务人员再次为你申请追加体验次数。');
    function alertMsg(msg, mode) { //mode为空，即只有一个确认按钮，mode为1时有确认和取消两个按钮
      msg = msg || '';
      mode = mode || 0;
      var top = document.body.scrollTop || document.documentElement.scrollTop;
      var isIe = (document.all) ? true : false;
      var isIE6 = isIe && !window.XMLHttpRequest;
      var sTop = document.documentElement.scrollTop || document.body.scrollTop;
      var sLeft = document.documentElement.scrollLeft || document.body.scrollLeft;
      var winSize = function () {
        var xScroll, yScroll, windowWidth, windowHeight, pageWidth, pageHeight;
        // innerHeight获取的是可视窗口的高度，IE不支持此属性
        if (window.innerHeight && window.scrollMaxY) {
          xScroll = document.body.scrollWidth;
          yScroll = window.innerHeight + window.scrollMaxY;
        } else if (document.body.scrollHeight > document.body.offsetHeight) { // all but Explorer Mac
          xScroll = document.body.scrollWidth;
          yScroll = document.body.scrollHeight;
        } else { // Explorer Mac...would also work in Explorer 6 Strict, Mozilla and Safari
          xScroll = document.body.offsetWidth;
          yScroll = document.body.offsetHeight;
        }

        if (self.innerHeight) {    // all except Explorer
          windowWidth = self.innerWidth;
          windowHeight = self.innerHeight;
        } else if (document.documentElement && document.documentElement.clientHeight) { // Explorer 6 Strict Mode
          windowWidth = document.documentElement.clientWidth;
          windowHeight = document.documentElement.clientHeight;
        } else if (document.body) { // other Explorers
          windowWidth = document.body.clientWidth;
          windowHeight = document.body.clientHeight;
        }

        // for small pages with total height less then height of the viewport
        if (yScroll < windowHeight) {
          pageHeight = windowHeight;
        } else {
          pageHeight = yScroll;
        }

        // for small pages with total width less then width of the viewport
        if (xScroll < windowWidth) {
          pageWidth = windowWidth;
        } else {
          pageWidth = xScroll;
        }

        return {
          'pageWidth': pageWidth,
          'pageHeight': pageHeight,
          'windowWidth': windowWidth,
          'windowHeight': windowHeight
        }
      }();
      //alert(winSize.pageWidth);
      //遮罩层
      var styleStr = 'top:0;left:0;position:absolute;z-index:10000;background:#666;width:' + winSize.pageWidth + 'px;height:' + (winSize.pageHeight + 30) + 'px;';
      styleStr += (isIe) ? "filter:alpha(opacity=80);" : "opacity:0.8;"; //遮罩层DIV
      var shadowDiv = document.createElement('div'); //添加阴影DIV
      shadowDiv.style.cssText = styleStr; //添加样式
      shadowDiv.id = "shadowDiv";
      //如果是IE6则创建IFRAME遮罩SELECT
      if (isIE6) {
        var maskIframe = document.createElement('iframe');
        maskIframe.style.cssText = 'width:' + winSize.pageWidth + 'px;height:' + (winSize.pageHeight + 30) + 'px;position:absolute;visibility:inherit;z-index:-1;filter:alpha(opacity=0);';
        maskIframe.frameborder = 0;
        maskIframe.src = "about:blank";
        shadowDiv.appendChild(maskIframe);
      }
      document.body.insertBefore(shadowDiv, document.body.firstChild); //遮罩层加入文档
      //弹出框
      var styleStr1 = 'display:block;position:fixed;_position:absolute;left:0;right: 0;top: 186px;margin: auto;top:' + (winSize.windowHeight / 2 - 150) + 'px;_top:' + (winSize.windowHeight / 2 + top - 150) + 'px;'; //弹出框的位置
      var alertBox = document.createElement('div');
      alertBox.id = 'alertMsg';
      alertBox.style.cssText = styleStr1;
      // 创建关闭按钮
      var alertMsg_close = document.createElement('span');
      alertMsg_close.id = 'alertMsg_close';
      alertMsg_close.style.cssText = 'float:right;text-align: right;';
      alertMsg_close.innerHTML = '<img src="http://tin.1yuaninfo.com/public/static/index/zhuce/img/close_icon_1.png" width="55%">';
      alertBox.appendChild(alertMsg_close);
      //创建弹出框里面的内容P标签
      var alertMsg_info = document.createElement('P');
      alertMsg_info.id = 'alertMsg_info';
      alertMsg_info.innerHTML = msg;
      alertBox.appendChild(alertMsg_info);
      //创建按钮
      var btn1 = document.createElement('a');
      btn1.id = 'alertMsg_btn1';
      btn1.href = 'javas' + 'cript:void(0)';
      btn1.innerHTML = '<cite style="display:block;padding:5px 70px;background:#fa4844;color:#fff;border-radius:5px;margin-bottom:10px;border-top:10px; ">申请继续体验</cite>';
      alertMsg_close.onclick = function () {
        WeixinJSBridge.call('closeWindow');
      }
      btn1.onclick = function () {
        //  WeixinJSBridge.call('closeWindow');
        $.ajax({
          type: "GET",
          url: "http://tin.1yuaninfo.com/index/news/await",
          data: {
            openid: $(".openid").val(),
            s_id: $(".s_id").val()
          },
          dataType: "json",
          success: function (data) {
            console.log(data);
            console.log(111111111)
            $("#alertMsg").hide()
            alertMsgBlack("请注意接听010-67725155客服来电，会有工作人员帮助你追加体验服务次数。")
          },
          error:function (err){
            console.log(err);
          }
        });
      };
      alertBox.appendChild(btn1);
      if (mode === 1) {
        var btn2 = document.createElement('a');
        btn2.id = 'alertMsg_btn2';
        btn2.href = 'javas' + 'cript:void(0)';
        btn2.innerHTML = '<cite>取消</cite>';
        btn2.onclick = function () {
          document.body.removeChild(alertBox);
          document.body.removeChild(shadowDiv);
          return false;
        };
        alertBox.appendChild(btn2);
      }
      document.body.appendChild(alertBox);

    }
    // 弹出一个提示语句（黑色背景+白色文字） alertMsg('请输入手机号')
 function alertMsgBlack (txt) {
  var alertFram = document.createElement("DIV");
  alertFram.id = "alertFram";
  alertFram.style.position = "fixed";
  alertFram.style.width = "80%";
  // alertFram.style.textAlign = "center";
  alertFram.style.top = "36%";
  alertFram.style.left = "0";
  alertFram.style.right = "0";
  alertFram.style.margin = "auto";
  alertFram.style.zIndex = "100001";
  strHtml = " <span style=\"font-family: 微软雅黑;display:inline-block;background:rgba(0,0,0,0.8);color:#fff;padding:0 20px;line-height:36px;border-radius:6px; \">" + txt + "</span>";
  alertFram.innerHTML = strHtml;
  document.body.appendChild(alertFram);
  setTimeout((function () {
    alertFram.style.display = "none";
    WeixinJSBridge.call('closeWindow');
  }), 5000);
};
  </script>
</body>

</html>